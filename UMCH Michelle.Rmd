---
title: "UMCH"
author: "Cora Boyoung Jung, Enoch Mwesigwa, Jordan Severn"
output:
  html_document:
    df_print: paged
  pdf_document: default
---


```{r setup, include=FALSE}
library(plyr)  ## or dplyr (transform -> mutate) 
require(mosaic)
require(ggformula)
require(tidyverse)
require(s245)
require(DHARMa)
library(reticulate) # for using python
library(reactable) #install.packages("reactable") may need to run once
knitr::opts_chunk$set(echo = FALSE, 
                      error = FALSE,
                      message = FALSE,
                      warning=FALSE,
                      fig.width = 10, fig.height = 6)

theme_set(theme_minimal(base_size = 12))
```


```{r import-data}
UMCHdata <- read_csv("https://raw.githubusercontent.com/Cora-Boyoung-Jung/UMCH/main/data/UMCH_p.csv",
                     col_types = cols(Birthdate = col_date(format = "%m/%d/%Y"),
                                      Age = col_integer()))
```

```{r tidy-data}
UMCH <- UMCHdata %>% mutate(Status = tolower(Status))
neworder <- c("infant","toddler","two_year", "three_year", "four_year")

UMCH <- arrange(transform(UMCH,
             AgeGroup=factor(AgeGroup,levels=neworder)),AgeGroup)
```

## Graphics

#### Which domain in the areas of development is scored the lowest and highest in which age group and overall?  

```{r}
UMCH_long <- UMCH %>%
  subset(select = -c(Filename, Birthdate, Age, Gender, TotalScore, Status, Examiner,Adaptive_SelfHelp, Adaptive_SocialEmotional, LanguageDevelopment,AcademicAndCognitive,PhysicalDevelopment, AcademicAndCognitive_Literacy, AcademicAndCognitive_Maths)) %>%
  pivot_longer(!AgeGroup, names_to = "Domain", values_to = "Score") %>%
  na.omit() %>%
  mutate(AgeGroup = as.factor(AgeGroup),
         Domain = as.factor(Domain),
         Score = as.numeric(Score))

UMCH_stat <- UMCH_long %>%
  dplyr::group_by(AgeGroup,Domain) %>%
  dplyr::summarise(Min=min(Score),
                   Max=max(Score),
                   Mean=mean(Score),
                   Median=median(Score))

UMCH_stat %>%
  knitr::kable()
```
```{r max}
ggplot(UMCH_stat, aes(x = Domain,  y = Max, color=AgeGroup)) +
  geom_point() + 
  facet_wrap(~AgeGroup) +
  labs(title="Maximum Score of Children Grouped by AgeGroup and Domain", y="Score") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  expand_limits(y = 0)
```
```{r min}
ggplot(UMCH_stat, aes(x = Domain,  y = Min, color=AgeGroup)) +
  geom_point() + 
  facet_wrap(~AgeGroup) +
  labs(title="Minimum Score of Children Grouped by AgeGroup and Domain", y="Score") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  expand_limits(y = 0)
```
```{r mean}
ggplot(UMCH_stat, aes(x = Domain,  y = Mean, color=AgeGroup)) +
  geom_point() + 
  facet_wrap(~AgeGroup) +
  labs(title="Average Score of Children Grouped by AgeGroup and Domain", y="Score") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  expand_limits(y = 0)
```
```{r median}
ggplot(UMCH_stat, aes(x = Domain,  y = Median, color=AgeGroup)) +
  geom_point() + 
  facet_wrap(~AgeGroup) +
  labs(title="Median Score of Children Grouped by AgeGroup and Domain", y="Score") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  expand_limits(y = 0)
```

### How does score vary by age group?  
```{r totalscore-by-agegroup}
gf_histogram(~TotalScore, data=UMCH, fill='#00BFC4', color='black') %>% 
  gf_labs(title="Total Scores by Age Group", x="Total Score", y="Counts") + facet_wrap(~AgeGroup)
```

### How does score vary by gender?  
```{r totalscore-by-gender-and-agegroup}
ggplot(UMCH, aes(x = Gender,  y = TotalScore, fill=Gender)) +
  geom_boxplot() + 
  facet_wrap(~AgeGroup) +
  labs(title="Total Scores by Gender for Each AgeGroup", x="Gender") +
  expand_limits(y = 0)
```

## TotalScore Model

We used linear regression model because it is used to show/predict the relationship between variables where the response variable is continuous. We can use up to 2 predictors given the size of the data (36/15). We will not add any interaction or random effect due to the size of the dataset. Our predictors will be Age and Gender because all other variables contributes to the Total Score which does not make logical sense to include those.     
Response variable: TotalScore 
Predictor(s): Age, Gender   
Regression model: Linear regression 

```{r}
mod_total <- lm(TotalScore ~ Age + Gender,  
          data = UMCH)  
```

## Prediction Plot

```{r pred-plot-age}
pred_plot(mod_total, 'Age') %>%
  gf_labs(y = 'Predicted Score',
          title = 'Prediction Plot on Age')
```

```{r pred-plot-gender}
pred_plot(mod_total, 'Gender') %>%
  gf_labs(y = 'Predicted Score',
          title = 'Prediction Plot on Gender')
```

According to the prediction plot for Age, there seems to be a positive trend between the score and age where as age increases, the score also increases. This makes sense because the "pass" score for each age group differs according to the age with lower age having the lowest pass score.  
According to the prediction plot for Gender, it looks like the total score is a little higher for female compared to male. However, the overlapping range is high and the number of children is not the same (21 females and 15 males), so it brings down the reliability score of this data but it is worth noting.  






