---
title: "UMCH"
author: "Cora Boyoung Jung, Enoch Mwesigwa, Jordan Severn"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output: 
  pdf_document:
    fig_height: 2.2
    fig_width: 4
---

```{r setup, include=FALSE}
require(mosaic)
require(ggformula)
require(tidyverse)
require(s245)
require(DHARMa)
knitr::opts_chunk$set(echo = TRUE, 
                      error = TRUE,
                      message = FALSE,
                      fig.width = 8, fig.height = 4)

theme_set(theme_minimal(base_size = 12))
```

## Import csv & Change data type
  
```{r}
UMCHdata <- read_csv("data/UMCH.csv",
                     col_types = cols(Birthdate = col_date(format = "%m/%d/%Y"),
                                      Age = col_integer()))
glimpse(UMCHdata)
```


UMCHdata <- read_csv("https://raw.githubusercontent.com/Cora-Boyoung-Jung/UMCH/main/data/UMCH.csv",
                     col_types = cols(Birthdate = col_date(format = "%m/%d/%Y"),
                                      Age = col_integer()))
glimpse(UMCHdata)



## Tidying data
  
```{r}
UMCH <- UMCHdata %>% mutate(Status = tolower(Status))
neworder <- c("infant","toddler","two_year", "three_year", "four_year")
library(plyr)  ## or dplyr (transform -> mutate)
UMCH <- arrange(transform(UMCH,
             AgeGroup=factor(AgeGroup,levels=neworder)),AgeGroup)
```

## Exploring data set
  
```{r}
head(UMCH)
summary(UMCH)
```

## Draft Graphics

- Which domain in the areas of development is scored the lowest and highest in which age group and overall? 
```{r physical-agegroup}
ggplot(UMCH, aes(x = AgeGroup,  y = PhysicalDevelopment, color = Status)) +
  geom_point() +
  labs(x = "Age Group",
       y = "Physical Development Score",
       title = "Number of Passes and Fails by Physical Development Score")
```
```{r language-by-agegroup}
ggplot(UMCH, aes(x = AgeGroup,  y = LanguageDevelopment, color = Status)) +
  geom_point() +
  labs(x = "Age Group",
       y = "Language Development Score",
       title = "Number of Passes and Fails by Language Development Score")

```
- How does score vary by age group?  
```{r totalscore-by-agegroup}
gf_histogram(~TotalScore, data=UMCH, fill="blue", color='black') %>% 
  gf_labs(title="Total Scores by Age Group", x="Total Score", y="Counts") + facet_wrap(~AgeGroup)

```

## Draft Models

For all models, we used linear regression model because it is used to show/predict the relationship between variables where the response variable is continuous. We can use up to 2 predictors given the size of the data (36/15). We will not add any interaction or random effect due to the size of the dataset. Our predictors will be Age and Gender because all other variables contributes to the Total Score which does not make logical sense to include those.     

### Model Predicting PhysicalDevelopment  
   
Response variable: PhysicalDevelopment  
Predictor(s): Age, Gender   
Regression model: Linear regression  

```{r}
mod_phy <- lm(PhysicalDevelopment ~ Age + Gender, 
          data = UMCH)

summary(mod_phy)
```

### Model Predicting LanguageDevelopment  
  
Response variable: LanguageDevelopment  
Predictor(s): PhysicalDevelopment, TotalScore   
Regression model: Linear regression  

```{r}
mod_lan <- lm(LanguageDevelopment ~ Age + Gender, 
          data = UMCH)

summary(mod_lan)
```

### TotalScore Model  
    
Response variable: TotalScore 
Predictor(s): Age, Gender   
Regression model: Linear regression 

```{r}
mod_total <- lm(TotalScore ~ Age + Gender,  
          data = UMCH)  
summary(mod_total)  
```

## Model Assesment



## Interpretation

