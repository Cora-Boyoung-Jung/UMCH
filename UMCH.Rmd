---
title: "UMCH"
author: "Cora Boyoung Jung, Enoch Mwesigwa, Jordan Severn"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output: 
  pdf_document:
    fig_height: 2.2
    fig_width: 4
---

```{r setup, include=FALSE}
require(mosaic)
require(ggformula)
require(tidyverse)
require(s245)
require(DHARMa)
knitr::opts_chunk$set(echo = TRUE, 
                      error = TRUE,
                      message = FALSE,
                      fig.width = 8, fig.height = 4)

theme_set(theme_minimal(base_size = 12))
```

## Import csv & Change data type
  

UMCHdata <- read_csv("https://raw.githubusercontent.com/Cora-Boyoung-Jung/UMCH/main/data/UMCH.csv", 
                 col_types = cols(Birthdate = col_date(format = "%m/%d/%Y"), 
                                  AgeYear = col_integer(), 
                                  AgeMonth = col_integer(), 
                                  AgeDay = col_integer()))

glimpse(UMCHdata)

```{r}
UMCHdata <- read_csv("data/UMCH.csv",
                     col_types = cols(Birthdate = col_date(format = "%m/%d/%Y"),
                                      Age = col_integer()))
glimpse(UMCHdata)
```


## Tidying data
  
```{r}
UMCH <- UMCHdata %>% mutate(Status = tolower(Status))
neworder <- c("infant","toddler","two_year", "three_year", "four_year")
library(plyr)  ## or dplyr (transform -> mutate)
UMCH <- arrange(transform(UMCH,
             AgeGroup=factor(AgeGroup,levels=neworder)),AgeGroup)
```

## Exploring data set
  
```{r}
head(UMCH)
summary(UMCH)
```

## Draft Graphics

- Which domain in the areas of development is scored the lowest and highest in which age group and overall? 
```{r physical-agegroup}
ggplot(UMCH, aes(x = AgeGroup,  y = PhysicalDevelopment, color = Status)) +
  geom_point() +
  labs(x = "Age Group",
       y = "Physical Development Score",
       title = "Number of Passes and Fails by Physical Development Score")
```
```{r language-by-agegroup}
ggplot(UMCH, aes(x = AgeGroup,  y = LanguageDevelopment, color = Status)) +
  geom_point() +
  labs(x = "Age Group",
       y = "Language Development Score",
       title = "Number of Passes and Fails by Language Development Score")

```
- How does score vary by age group?  
```{r totalscore-by-agegroup}
gf_histogram(~TotalScore, data=UMCH, fill="blue", color='black') %>% 
  gf_labs(title="Total Scores by Age Group", x="Total Score", y="Counts") + facet_wrap(~AgeGroup)

```

## Draft Models

### Model Predicting PhysicalDevelopment  
   
Response variable: PhysicalDevelopment  
Predictor(s): LanguageDevelopment, TotalScore   
Regression model: Linear regression  

This model will show if there is a relationship between the Language Development and Physical Development of the child. We chose these two because all the age groups are graded on that category. In this first model, Physical development is the response variable. We also chose to add TotalScore to see if knowing how well the child did on the whole exam would help the prediction. This is a linear model because the response variable is continuous. We can use up to 2 predictors given the size of the data set (33/15). We will not add any interaction or random effect due to the size of our dataset.  If it was larger, it would be interesting to explore the interaction between Language Development and Status. Perhaps whether or not a student passed affect the degree of which Language development can impact physical development. The same could be explored for the interaction between Language Development and Age group. But we may be able to get some insight into those with our prediction plots.

```{r}
mod_phy <- lm(PhysicalDevelopment ~ TotalScore + LanguageDevelopment, 
          data = UMCH)

summary(mod_phy)
```

### Model Predicting LanguageDevelopment  
  
Response variable: LanguageDevelopment  
Predictor(s): PhysicalDevelopment, TotalScore   
Regression model: Linear regression  

This model will show if there is a relationship between the Language Development and Physical Development of the child. We chose these two because all the age groups are graded on that category. In this first model, Language development is the response variable. We also chose to add TotalScore to see if knowing how well the child did on the whole exam would help the prediction. This is a linear model because the response variable is continuous. We can use up to 2 predictors given the size of the data set (33/15). We will not add any interaction or random effect due to the size of our dataset.  

```{r}
mod_lan <- lm(LanguageDevelopment ~ TotalScore + PhysicalDevelopment, 
          data = UMCH)

summary(mod_lan)
```

### Alternative Model  
    
This is another alternative model we are thinking after we receive "Gender" information on the children next week. 

Response variable: TotalScore 
Predictor(s): Age, Gender   
Regression model: Linear regression 

We chose TotalScore as our response variable and Age and Gender as our predictor variable because we want to know whether the Age and Gender have effect on the TotalScore. We chose linear regression model because it is used to show or predict the relationship between two variables where the response variable is continuous. We can use up to 2 predictors given the size of the data set (33/15). We will not add any interaction or random effect due to the size of our dataset.   
  
```{r}
mod_alt <- lm(TotalScore ~ Age + Gender,  
          data = UMCH)  
summary(mod_alt)  
```